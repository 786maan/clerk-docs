---
title: Sync Host configuration
description: Learn how to configure your Chrome Extension to sync user authentication with your web application.
---

The Sync Host feature enables your user's session in your web application to be synced with your Chrome Extension. As soon as a user authenticates in your web application, the user will be authenticated in your Chrome Extension as well.

> [!NOTE]
> This guide is based on using the [Plasmo](https://www.plasmo.com/) framework and having following the [React Router for Chrome Extension](/docs/references/chrome-extension/add-react-router) guide. You may need to adjust the implementation and edite files based off of your specific configuration.

<Steps>
  ### Add `CLERK_SYNC_HOST` to your environment variables

  1. Add `PLASMO_PUBLIC_SYNC_HOST` to your `.env.development` and `.env.production` files.
  1. For `.env.development` use the domain your development app runs on. If you are using a Vite based React application, then you would likely use `localhost:5173`
  2. For `.env.production` use the domain for your deployed web application. For example, `clerk.com`

> [!NOTE] 
> Do not add `http://` or `https://` during this step.

  {/* TODO: Alexis, maybe tabs for .env.development and .env.production? */}
  ```tsx {{ filename: '.env.development', mark: [3], prettier: false }}
  PLASMO_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_
  CLERK_FRONTEND_API=  
  PLASMO_PUBLIC_SYNC_HOST=localhost:5173
  ```
  
  ### Add `syncHost` prop to your `<ClerkProvider>`

  
  ```tsx {{ filename: 'src/popup/layouts/root-layout.tsx', mark: [10, [12,14], 27] }}
  import { Link, Outlet, useLocation, useNavigate } from "react-router-dom";
  import {
    ClerkProvider,
    SignedIn,
    SignedOut,
    UserButton,
  } from "@clerk/chrome-extension";

  const PUBLISHABLE_KEY = process.env.PLASMO_PUBLIC_CLERK_PUBLISHABLE_KEY
  const SYNC_HOST = process.env.PLASMO_PUBLIC_SYNC_HOST

  if (!PUBLISHABLE_KEY || !SYNC_HOST) {
    throw new Error('Please add the PLASMO_PUBLIC_CLERK_PUBLISHABLE_KEY and PLASMO_PUBLIC_SYNC_HOST to the .env.development file')
  }

  export const RootLayout = () => {
    const navigate = useNavigate();
    const location = useLocation();

    console.log("location", location);
    return (
      <ClerkProvider
        routerPush={(to) => navigate(to)}
        routerReplace={(to) => navigate(to, { replace: true })}
        publishableKey={PUBLISHABLE_KEY}
        afterSignOutUrl="/"
        syncHost={`http://${SYNC_HOST}`}
      >
        <div className="plasmo-w-[785px] plasmo-h-[600px] plasmo-flex plasmo-flex-col">
          <main className="plasmo-grow plasmo-border-2 plasmo-border-red-500">
            <Outlet />
          </main>
          <footer className="plasmo-border-2 plasmo-border-green-500">
            <SignedIn>
              <Link to="/sdk-features">SDK Features</Link>
              <Link to="/settings">Settings</Link>
              <UserButton />
            </SignedIn>
            <SignedOut>
              <Link to="/">Home</Link>
              <Link to="/sign-in">Sign In</Link>
              <Link to="/sign-up">Sign Up</Link>
            </SignedOut>
          </footer>
        </div>
      </ClerkProvider>
    );
  };
```

  ### Configure `host_permissions`

  `host_permissions` allows you to specify which hosts, or websites, will have permission to sync auth state with your application. It accepts an array, allowing you to add more than one host.

  The values for your web application and of the Clerk Frontend API will be different for development and production. Using `.env.development` and `.env.production` will allow you to pass those values to your development and production builds seamlessly.

  1. Open your `manifest.json` file and edit the `host_permissions` key.
  1. Remove `http://localhost/*` or similiar is present and replace with `$PLASMO_PUBLIC_SYNC_HOST/*`. 

  The following examples shows how to configure `host_permissions`:

  ```json {{ filename: '/package.json' }}
  "manifest": {
    "permissions": [
      "cookies",
      "storage"
    ],
    "host_permissions": [
      "http://$PLASMO_PUBLIC_SYNC_HOST/*"
      "$CLERK_FRONTEND_API/*"
    ],
    "key": "$CRX_PUBLIC_KEY"
  }
  ```

  ### Configure `permissions`

  `permissions` allows you to specify which permissions your extension requires.

  1. Open your `manifest.json` file and add the `permissions` key.
  1. Add `"cookies"` and `"storage"` to the array as shown in the following example:

  ```json {{ filename: '/package.json' }}
  {
    // ... the rest of your package.json
    "permissions": ["cookies", "storage"]
  }
  ```

  ### Add the Extension's ID to your instance's `allowed_origins`

  For web applications, Clerk requires you to set a **domain** in your Clerk Dashboard. For Chrome Extensions, the **extension ID** is used _instead_ of a domain. You must add this to your application's settings via the Backend API instead of the Clerk Dashboard.

  > [!NOTE]
  > Completing the steps from the [Configure a consistent key](/docs/references/chrome-extension/configure-consistent-key) guide will prevent you from having to do this repeatedly.

  <SignedIn>
    In your terminal, paste the following command and replace the `<CHROME_EXTENSION_KEY>` with your extension's ID.
  </SignedIn>

  <SignedOut>
    1. Navigate to the Clerk Dashboard.
    1. In the navigation sidebar, select [API Keys](https://dashboard.clerk.com/last-active?path=api-keys).
    1. Copy your secret key.
    1. In your terminal, paste the following command and replace `YOUR_SECRET_KEY` with your Clerk secret key, and the `<CHROME_EXTENSION_KEY>` with your extension's ID.

    The final result should resemble the following:
  </SignedOut>

  ```bash {{ filename: 'terminal' }}
  curl -X PATCH https://api.clerk.com/v1/instance \
    -H "Authorization: Bearer {{secret}}" \
    -H "Content-type: application/json" \
    -d '{"allowed_origins": ["chrome-extension://<CHROME_EXTENSION_ID>"]}'
  ```

  > [!NOTE]
  > Make sure that you use the Chrome Extension ID and not the Key with the above command.

  Running the command will add the extension's ID to your instance's `allowed_origins`.
</Steps>
